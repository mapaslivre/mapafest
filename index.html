<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gincana MapaFest 2025 - Regi√µes Hist√≥ricas</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f4f6f8; }
  h1 { text-align: center; color: #2a9d8f; }
  input, button, select { padding: 8px; margin: 5px; }
  table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background: #2a9d8f; color: #fff; }
  .grupoA { background: #f1f8e9; }
  .grupoB { background: #e3f2fd; }
  .grupoC { background: #fff3e0; }
  .grupoD { background: #fce4ec; }
  .msg { font-weight: bold; color: #1565c0; margin-top: 10px; }
  .csv-btn { background: #1565c0; color: #fff; border: none; padding: 8px 12px; cursor: pointer; border-radius: 6px; }
  .csv-btn:hover { background: #0d47a1; }
  .ranking-geral { background: #fff; border-radius: 8px; padding: 10px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  .ranking-geral h2 { text-align: center; color: #264653; }
  .posicao { font-weight: bold; font-size: 18px; margin: 5px 0; }
  .primeiro { color: gold; }
  .segundo { color: silver; }
  .terceiro { color: #cd7f32; }
  .lema { font-size: 13px; color: #555; font-style: italic; margin-top: -6px; }
</style>
</head>
<body>

<h1>üèÜ Gincana MapaFest 2025 - Regi√µes Hist√≥ricas</h1>
<p style="text-align:center;">Mapeando o Brasil pelas suas origens ‚Äî cada ponto, uma hist√≥ria.</p>

<div class="ranking-geral">
  <h2>üèÅ Ranking Geral dos Grupos</h2>
  <div id="rankingGeral"></div>
</div>

<h3>üó∫Ô∏è Tarefas dispon√≠veis:</h3>
<ul id="listaTarefas">
  <li>1Ô∏è‚É£ Mapear ruas do bairro central</li>
  <li>2Ô∏è‚É£ Adicionar nomes de edif√≠cios hist√≥ricos</li>
  <li>3Ô∏è‚É£ Mapear pra√ßas e √°reas verdes</li>
  <li>4Ô∏è‚É£ Corrigir nomes duplicados de ruas</li>
  <li>5Ô∏è‚É£ Adicionar ciclovias e pistas de caminhada</li>
  <li>6Ô∏è‚É£ Mapeamento livre em qualquer lugar do Brasil</li>
  <li>7Ô∏è‚É£ Mapear 5 edifica√ß√µes em um bairro</li>
  <li>8Ô∏è‚É£ Mapear √°rvores em qualquer lugar do Brasil</li>
  <li>9Ô∏è‚É£ Mapear uma √°rea verde no limite da Amaz√¥nia Legal</li>
</ul>

<h3>üö© Registrar atividade:</h3>
<input type="text" id="nomeParticipante" placeholder="Nome do participante">
<select id="grupoSelect">
  <option value="">Selecione o grupo</option>
  <option value="A">üó∫Ô∏è Capitanias</option>
  <option value="B">üèûÔ∏è Sert√µes</option>
  <option value="C">‚õ™ Miss√µes</option>
  <option value="D">‚úäüèø Quilombos</option>
</select>
<input type="number" id="atividade" min="1" max="9" placeholder="N¬∫ da tarefa">
<button onclick="registrarAtividade()">Registrar</button>
<div id="mensagem" class="msg"></div>

<h3>üìä Detalhamento dos Grupos e Participantes</h3>
<table id="rankingTable">
  <thead>
    <tr>
      <th>Grupo</th>
      <th>Participante</th>
      <th>Atividade</th>
      <th>Pontos</th>
      <th>Confirmar</th>
      <th>Total do Grupo</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<button class="csv-btn" onclick="baixarCSV()">‚¨áÔ∏è Baixar Ranking em CSV</button>

<script>
const grupos = {
  A: { nome: "üó∫Ô∏è Capitanias", lema: "De onde tudo come√ßou.", total: 0, cor: "grupoA", participantes: [] },
  B: { nome: "üèûÔ∏è Sert√µes", lema: "Explorando caminhos e descobertas.", total: 0, cor: "grupoB", participantes: [] },
  C: { nome: "‚õ™ Miss√µes", lema: "Mapeando pela uni√£o dos povos.", total: 0, cor: "grupoC", participantes: [] },
  D: { nome: "‚úäüèø Quilombos", lema: "Mapeando com coragem e liberdade.", total: 0, cor: "grupoD", participantes: [] }
};

const tarefas = {
  1: "Mapear ruas do bairro central",
  2: "Adicionar nomes de edif√≠cios hist√≥ricos",
  3: "Mapear pra√ßas e √°reas verdes",
  4: "Corrigir nomes duplicados de ruas",
  5: "Adicionar ciclovias e pistas de caminhada",
  6: "Mapeamento livre em qualquer lugar do Brasil",
  7: "Mapear 5 edifica√ß√µes em um bairro",
  8: "Mapear √°rvores em qualquer lugar do Brasil",
  9: "Mapear uma √°rea verde no limite da Amaz√¥nia Legal"
};

function registrarAtividade() {
  const nome = document.getElementById('nomeParticipante').value.trim();
  const grupoId = document.getElementById('grupoSelect').value;
  const atividadeNum = document.getElementById('atividade').value;
  const msg = document.getElementById('mensagem');

  msg.textContent = "";

  if (!nome || !grupoId || !atividadeNum) {
    msg.textContent = "‚ö†Ô∏è Preencha todas as informa√ß√µes!";
    return;
  }

  const grupo = grupos[grupoId];
  let participante = grupo.participantes.find(p => p.nome.toLowerCase() === nome.toLowerCase());
  if (!participante) {
    participante = { nome, atividades: [], pontos: 0 };
    grupo.participantes.push(participante);
  }

  const jaExiste = participante.atividades.find(a => a.nome === tarefas[atividadeNum]);
  if (jaExiste) {
    msg.textContent = "‚ö†Ô∏è Essa tarefa j√° foi registrada para este participante.";
    return;
  }

  participante.atividades.push({ nome: tarefas[atividadeNum], concluido: false });
  msg.textContent = `üìù ${nome} iniciou a tarefa "${tarefas[atividadeNum]}" (${grupo.nome})`;
  atualizarTabelas();

  document.getElementById('nomeParticipante').value = '';
  document.getElementById('grupoSelect').value = '';
  document.getElementById('atividade').value = '';
}

function confirmarTarefa(gId, nomeParticipante, indexAtividade) {
  const grupo = grupos[gId];
  const participante = grupo.participantes.find(p => p.nome === nomeParticipante);
  const atividade = participante.atividades[indexAtividade];

  if (atividade.concluido) return;

  atividade.concluido = true;
  participante.pontos += 1;
  grupo.total += 1;

  document.getElementById('mensagem').textContent = `‚úÖ ${nomeParticipante} concluiu "${atividade.nome}" (${grupo.nome})!`;
  atualizarTabelas();
}

function atualizarTabelas() {
  const tbody = document.getElementById('rankingTable').getElementsByTagName('tbody')[0];
  tbody.innerHTML = "";

  Object.keys(grupos).forEach(gId => {
    const g = grupos[gId];
    g.participantes.forEach(p => {
      p.atividades.forEach((a, i) => {
        const row = tbody.insertRow();
        row.className = g.cor;
        row.insertCell(0).innerHTML = `${g.nome}<div class='lema'>${g.lema}</div>`;
        row.insertCell(1).innerText = p.nome;
        row.insertCell(2).innerText = a.nome;
        row.insertCell(3).innerText = p.pontos;
        const btnCell = row.insertCell(4);
        if (a.concluido) {
          btnCell.innerHTML = "‚úÖ Feito";
        } else {
          const btn = document.createElement('button');
          btn.textContent = "Confirmar";
          btn.onclick = () => confirmarTarefa(gId, p.nome, i);
          btnCell.appendChild(btn);
        }
        row.insertCell(5).innerText = g.total;
      });
    });
  });

  const rankingDiv = document.getElementById('rankingGeral');
  const gruposOrdenados = Object.values(grupos).sort((a, b) => b.total - a.total);
  rankingDiv.innerHTML = "";
  gruposOrdenados.forEach((g, i) => {
    const posDiv = document.createElement('div');
    posDiv.className = "posicao";
    if (i === 0) posDiv.classList.add('primeiro');
    if (i === 1) posDiv.classList.add('segundo');
    if (i === 2) posDiv.classList.add('terceiro');
    posDiv.innerHTML = `${i+1}¬∫ - ${g.nome} (${g.total} pts) <div class='lema'>${g.lema}</div>`;
    rankingDiv.appendChild(posDiv);
  });
}

function baixarCSV() {
  let csv = "Grupo,Participante,Atividades Conclu√≠das,Pontos,Total do Grupo\\n";
  Object.keys(grupos).forEach(gId => {
    const g = grupos[gId];
    g.participantes.forEach(p => {
      const concluidas = p.atividades.filter(a => a.concluido).map(a => a.nome);
      csv += `${g.nome},${p.nome},\\"${concluidas.join("; ")}\\",${p.pontos},${g.total}\\n`;
    });
  });
  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'ranking_gincana_historica.csv';
  link.click();
}
</script>

</body>
</html>

