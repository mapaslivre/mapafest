<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>MapaFest - Prot칩tipo Avan칞ado</title>
<style>
body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; }
h1 { color: #2a9d8f; }
h2 { color: #264653; }
button { padding: 5px 10px; margin: 5px; cursor: pointer; }
.task { background: #fff; padding: 10px; margin: 10px 0; border-radius: 5px; box-shadow: 1px 1px 5px #ccc; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
th { background: #2a9d8f; color: #fff; }
.medal-bar { width: 100%; background: #ccc; border-radius: 10px; margin: 10px 0; overflow: hidden; height: 20px; }
.medal-progress { height: 100%; width: 0; text-align: center; color: #fff; line-height: 20px; font-weight: bold; transition: width 1s; }
.medal-bronze { background: #cd7f32; }
.medal-silver { background: #c0c0c0; color: #000; }
.medal-gold { background: #ffd700; color: #000; }
</style>
</head>
<body>

<h1>游끥 MapaFest 2025</h1>
<p>Complete tarefas de mapeamento no OpenStreetMap e ganhe medalhas! Cada tarefa conclu칤da adiciona pontos ao seu ranking.</p>

<h2>Tarefas Dispon칤veis</h2>
<div id="tasksContainer"></div>

<h2>Ranking</h2>
<table id="rankingTable">
  <thead>
    <tr>
      <th>Usu치rio</th>
      <th>Medalhas</th>
      <th>Pontos</th>
      <th>Progresso</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const tasks = [
  { id: 1, name: "Mapear ruas do bairro central", points: 1, completedBy: [] },
  { id: 2, name: "Adicionar nomes de edif칤cios hist칩ricos", points: 2, completedBy: [] },
  { id: 3, name: "Mapear pra칞as e bancos p칰blicos", points: 1, completedBy: [] },
  { id: 4, name: "Atualizar postes de ilumina칞칚o p칰blica", points: 2, completedBy: [] },
  { id: 5, name: "Adicionar ciclovias e pistas de caminhada", points: 1, completedBy: [] },
  { id: 6, name: "Verificar endere칞os e CEPs", points: 1, completedBy: [] },
  { id: 7, name: "Mapear hospitais e postos de sa칰de", points: 3, completedBy: [] },
  { id: 8, name: "Atualizar nomes de ruas novas", points: 2, completedBy: [] },
];

const ranking = [];

function renderTasks() {
  const container = document.getElementById('tasksContainer');
  container.innerHTML = '';
  tasks.forEach(task => {
    const div = document.createElement('div');
    div.className = 'task';
    div.innerHTML = `<strong>${task.name}</strong> - Pontos: ${task.points} 
      <button onclick="completeTask(${task.id})">Concluir Tarefa</button>`;
    container.appendChild(div);
  });
}

function completeTask(taskId) {
  const task = tasks.find(t => t.id === taskId);
  const userName = prompt("Digite seu nome de usu치rio:");
  if(!userName) return;

  // Checa se o usu치rio j치 completou a tarefa
  if(task.completedBy.includes(userName)){
    alert("Voc칡 j치 completou esta tarefa!");
    return;
  }

  task.completedBy.push(userName);

  // Adiciona ou atualiza usu치rio no ranking
  let user = ranking.find(r => r.user === userName);
  if(!user){
    user = { user: userName, points: 0, medals: [], progress: 0 };
    ranking.push(user);
  }

  user.points += task.points;

  // Atualiza medalha e progresso
  if(user.points >= 10){
    user.medals = ['游볞 Ouro'];
    user.progress = 100;
  } else if(user.points >= 5){
    user.medals = ['游볟 Prata'];
    user.progress = (user.points/10)*100;
  } else {
    user.medals = ['游볠 Bronze'];
    user.progress = (user.points/10)*100;
  }

  updateRanking();
}

function updateRanking(){
  const tbody = document.getElementById('rankingTable').getElementsByTagName('tbody')[0];
  tbody.innerHTML = '';

  // Ordena ranking por pontos
  ranking.sort((a,b) => b.points - a.points);

  ranking.forEach(r => {
    const row = tbody.insertRow();
    row.insertCell(0).innerText = r.user;
    row.insertCell(1).innerText = r.medals.join(' ');
    row.insertCell(2).innerText = r.points;

    // Barra de medalhas animada
    const progressCell = row.insertCell(3);
    const bar = document.createElement('div');
    bar.className = 'medal-bar';
    const progress = document.createElement('div');
    progress.className = 'medal-progress ' + (r.medals[0] === '游볞 Ouro' ? 'medal-gold' : r.medals[0] === '游볟 Prata' ? 'medal-silver' : 'medal-bronze');
    progress.style.width = r.progress + '%';
    progress.innerText = r.progress.toFixed(0) + '%';
    bar.appendChild(progress);
    progressCell.appendChild(bar);
  });
}

// Inicializa
renderTasks();
updateRanking();
</script>

</body>
</html>

